---
import Section from '../../layouts/section.astro';
import Button from '../atoms/button.astro';
import SectionName from '../atoms/section-name.astro';
import { getAllData as getAllProjects } from '../../services/data';
import Card from '../molecules/card.astro';

interface Project {
  title: string;
  metadata: {
    project_image: {
      imgix_url: string;
    };
    single_line_summary: string;
    alttext: string;
  };
}

const projects: Project[] = await getAllProjects(
  'projects',
  'title,metadata.project_image.imgix_url,metadata.alttext,metadata.single_line_summary,4'
);
---

<Section>
  <SectionName>My Projects</SectionName>
  <h2 class='h2'>
    Projects that I've worked in
    <br />
    past few years
  </h2>

  <div class='grid grid-cols-1 gap-x-[2.2rem] gap-y-4 projects md:grid-cols-2'>
    {
      projects.map(
        ({
          title,
          metadata: {
            alttext,
            project_image: { imgix_url },
            single_line_summary,
          },
        }) => (
          <Card
            title={title}
            altText={alttext}
            image={imgix_url}
            summary={single_line_summary}
          />
        )
      )
    }
  </div>

  <Button
    as='a'
    href='#'
    role='button'
    icon='right-arrow'
    class='mx-auto'
    iconSize={'h-2 w-2'}
  >
    View all Projects
  </Button>
</Section>

<style>
  .h2 {
    margin-block-end: 6.4rem;
  }
  .projects {
    margin-block-end: 9.6rem;
  }
</style>
